<Window x:Class="EditarePDF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:EditarePDF"
        mc:Ignorable="d"
        Title="EditarePDF" Height="700" Width="1100" Background="#FAFAFA">
    <DockPanel>
        <!-- Top Toolbar -->
        <Border DockPanel.Dock="Top" Background="#2D3748" Padding="10">
            <DockPanel>
                <TextBlock Text="EditarePDF" Foreground="White" FontSize="18" FontWeight="SemiBold" DockPanel.Dock="Left" VerticalAlignment="Center"/>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <StackPanel.Resources>
                        <!-- Elevated shadow used by buttons -->
                        <DropShadowEffect x:Key="BtnShadow" BlurRadius="15" ShadowDepth="2" Opacity="0.35" Color="#000000"/>

                        <!-- Elegant button style with subtle gradient, hover glow and press feedback -->
                        <Style TargetType="Button">
                            <Setter Property="Margin" Value="6"/>
                            <Setter Property="Padding" Value="16,10"/>
                            <Setter Property="Foreground" Value="#FFFFFF"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Setter Property="Cursor" Value="Hand"/>
                            <Setter Property="SnapsToDevicePixels" Value="True"/>
                            <Setter Property="FontSize" Value="16"/>
                            <Setter Property="FontWeight" Value="SemiBold"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Grid>
                                            <!-- Base background with gradient -->
                                            <Border x:Name="Bg" CornerRadius="10" Effect="{StaticResource BtnShadow}">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                        <GradientStop Color="#55607A" Offset="0"/>
                                                        <GradientStop Color="#414A61" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                            </Border>

                                            <!-- Soft highlight line at top -->
                                            <Border CornerRadius="10" Opacity="0.18">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                        <GradientStop Color="#FFFFFF" Offset="0"/>
                                                        <GradientStop Color="#FFFFFF00" Offset="0.3"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                            </Border>

                                            <!-- Content -->
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="8,4"/>
                                        </Grid>

                                        <ControlTemplate.Triggers>
                                            <!-- Hover: lighten and add glow -->
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="Bg" Property="Background">
                                                    <Setter.Value>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                            <GradientStop Color="#637092" Offset="0"/>
                                                            <GradientStop Color="#4B5672" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Setter.Value>
                                                </Setter>
                                                <Setter TargetName="Bg" Property="Effect">
                                                    <Setter.Value>
                                                        <DropShadowEffect BlurRadius="18" ShadowDepth="2" Opacity="0.45" Color="#1E90FF"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>

                                            <!-- Press: slight scale and deeper shade -->
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <ScaleTransform ScaleX="0.97" ScaleY="0.97"/>
                                                    </Setter.Value>
                                                </Setter>
                                                <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
                                                <Setter TargetName="Bg" Property="Background">
                                                    <Setter.Value>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                            <GradientStop Color="#35405A" Offset="0"/>
                                                            <GradientStop Color="#2C3449" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>

                                            <!-- Disabled -->
                                            <Trigger Property="IsEnabled" Value="False">
                                                <Setter Property="Opacity" Value="0.6"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>

                        <!-- Primary/accent button style -->
                        <Style x:Key="PrimaryButton" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                            <Setter Property="Foreground" Value="#FFFFFF"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Grid>
                                            <Border x:Name="Bg" CornerRadius="10" Effect="{StaticResource BtnShadow}">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                        <GradientStop Color="#2CB1B5" Offset="0"/>
                                                        <GradientStop Color="#277F83" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                            </Border>
                                            <Border CornerRadius="10" Opacity="0.18">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                        <GradientStop Color="#FFFFFF" Offset="0"/>
                                                        <GradientStop Color="#FFFFFF00" Offset="0.3"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                            </Border>
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="8,4"/>
                                        </Grid>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="Bg" Property="Background">
                                                    <Setter.Value>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                            <GradientStop Color="#34C9CE" Offset="0"/>
                                                            <GradientStop Color="#2B9599" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Setter.Value>
                                                </Setter>
                                                <Setter TargetName="Bg" Property="Effect">
                                                    <Setter.Value>
                                                        <DropShadowEffect BlurRadius="18" ShadowDepth="2" Opacity="0.45" Color="#00D1D1"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <ScaleTransform ScaleX="0.97" ScaleY="0.97"/>
                                                    </Setter.Value>
                                                </Setter>
                                                <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
                                                <Setter TargetName="Bg" Property="Background">
                                                    <Setter.Value>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                            <GradientStop Color="#1E5D60" Offset="0"/>
                                                            <GradientStop Color="#184A4D" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>
                                            <Setter Property="IsEnabled" Value="False">
                                                <Setter Property="Opacity" Value="0.6"/>
                                            </Setter>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </StackPanel.Resources>
                    <Button Content="Deschide PDF" Click="OpenPdf_Click"/>
                    <Button Content="Radieră (Alb)" Click="Eraser_Click"/>
                    <Button Content="Salvare ca..." Click="SaveMenuButton_Click">
                        <Button.ContextMenu>
                            <ContextMenu Placement="Bottom">
                                <MenuItem Header="PDF (*.pdf)" Click="SaveAsPdf_Click"/>
                                <MenuItem Header="Word (*.docx)" Click="SaveAsDocx_Click"/>
                                <MenuItem Header="Excel (*.xlsx)" Click="SaveAsXlsx_Click"/>
                                <MenuItem Header="PowerPoint (*.pptx)" Click="SaveAsPptx_Click"/>
                                <Separator/>
                                <MenuItem Header="PNG (*.png)" Click="SaveAsPng_Click"/>
                                <MenuItem Header="JPEG (*.jpg;*.jpeg)" Click="SaveAsJpeg_Click"/>
                            </ContextMenu>
                        </Button.ContextMenu>
                    </Button>

                </StackPanel>
            </DockPanel>
        </Border>

        <!-- Main Content Area -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="320"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Sidebar: Pages Thumbnails -->
            <Border Grid.Column="0" Background="#EDF2F7" BorderBrush="#E2E8F0" BorderThickness="0,1,1,0">
                <DockPanel>
                    <TextBlock Text="Pagini:" FontWeight="SemiBold" Foreground="#2D3748" Padding="12" DockPanel.Dock="Top"/>
                    <!-- Let ListBox manage its own scrolling and mouse wheel -->
                    <ListBox x:Name="PagesList"
                             SelectionChanged="PagesList_SelectionChanged"
                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                             ScrollViewer.CanContentScroll="True">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Margin="10" Orientation="Vertical">
                                    <Border Padding="6" Background="#E3E3E3" BorderBrush="#CBD5E0" BorderThickness="1" CornerRadius="6">
                                        <Image Source="{Binding Thumbnail}" Stretch="Uniform" Width="240"/>
                                    </Border>
                                    <TextBlock Text="{Binding PageNumber, StringFormat=Pagina {0}}"
                                               Foreground="#4A5568"
                                               FontSize="12"
                                               HorizontalAlignment="Center"
                                               Margin="0,6,0,0"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </DockPanel>
            </Border>

            <!-- Editor Surface with Zoom + Status Bar -->
            <Border Grid.Column="1" Margin="10" Background="#F5F5F5" BorderBrush="#E2E8F0" BorderThickness="1" CornerRadius="8">
                <DockPanel>
                    <!-- Bottom Status Bar inside the editor surface -->
                    <StatusBar DockPanel.Dock="Bottom" Background="#EDF2F7" BorderBrush="#E2E8F0" BorderThickness="1,1,0,0">
                        <StatusBarItem>
                            <TextBlock Text="Zoom:" Margin="6,0"/>
                        </StatusBarItem>
                        <StatusBarItem>
                            <ComboBox x:Name="ZoomCombo"
                                      Width="100"
                                      SelectedValuePath="Tag"
                                      SelectionChanged="ZoomCombo_SelectionChanged">
                                <ComboBoxItem Content="50%" Tag="0.5"/>
                                <ComboBoxItem Content="75%" Tag="0.75"/>
                                <ComboBoxItem Content="100%" Tag="1"/>
                                <ComboBoxItem Content="125%" Tag="1.25"/>
                                <ComboBoxItem Content="150%" Tag="1.5"/>
                                <ComboBoxItem Content="200%" Tag="2"/>
                            </ComboBox>
                        </StatusBarItem>
                        <StatusBarItem>
                            <Button Content="Actual size 1:1" Click="ActualSize_Click"/>
                        </StatusBarItem>
                        <StatusBarItem>
                            <Button Content="Fit to width" Click="FitToWidth_Click"/>
                        </StatusBarItem>
                        <StatusBarItem>
                            <Button Content="Best fit" Click="BestFit_Click"/>
                        </StatusBarItem>
                        <StatusBarItem>
                            <TextBlock x:Name="PageSizeText" Margin="12,0,0,0"/>
                        </StatusBarItem>
                    </StatusBar>

                    <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                        <!-- Shared transform ensures Pdf + InkCanvas scale together -->
                        <Grid x:Name="ContainerGrid" Margin="10">
                            <Grid.RenderTransform>
                                <ScaleTransform x:Name="ZoomTransform" ScaleX="1" ScaleY="1"/>
                            </Grid.RenderTransform>

                            <!-- Center the PDF image -->
                            <Image x:Name="PdfDisplayImage"
                                   Stretch="None"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"/>

                            <!-- Center the InkCanvas and match the image size -->
                            <InkCanvas x:Name="EraserCanvas"
                                       Background="Transparent"
                                       EditingMode="None"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       IsHitTestVisible="True"
                                       Width="{Binding ElementName=PdfDisplayImage, Path=ActualWidth}"
                                       Height="{Binding ElementName=PdfDisplayImage, Path=ActualHeight}"/>
                        </Grid>
                    </ScrollViewer>
                </DockPanel>
            </Border>
        </Grid>
    </DockPanel>
</Window>
